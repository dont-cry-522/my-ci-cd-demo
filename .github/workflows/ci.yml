name: æˆ‘çš„CI/CDå®éªŒ

on: [push, pull_request]

permissions:
  contents: write

jobs:
  test-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    # ç¬¬ä¸€æ­¥ï¼šè·å–ä»£ç 
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
    
    # ç¬¬äºŒæ­¥ï¼šæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
    - name: æ˜¾ç¤ºå½“å‰æ–‡ä»¶
      run: |
        echo "ğŸ“ å½“å‰ç›®å½•å†…å®¹ï¼š"
        ls -la
        echo ""
        echo "ğŸ“„ HTMLæ–‡ä»¶æ£€æŸ¥ï¼š"
        if [ -f "index.html" ]; then
          echo "âœ… æ‰¾åˆ° index.html æ–‡ä»¶"
          echo "æ–‡ä»¶å†…å®¹å‰å‡ è¡Œï¼š"
          head -5 index.html
        else
          echo "âŒ é”™è¯¯ï¼šæ‰¾ä¸åˆ° index.html"
          exit 1  # æ•…æ„å¤±è´¥
        fi
    
    # ç¬¬ä¸‰æ­¥ï¼šæ¨¡æ‹Ÿæµ‹è¯•é€šè¿‡
    - name: æµ‹è¯•é€šè¿‡åº†ç¥
      if: success()
      run: |
        echo "ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼"
        echo "å½“å‰æ—¶é—´ï¼š$(date)"
        echo "æäº¤è€…ï¼š${{ github.actor }}"
    
    # ç¬¬å››æ­¥ï¼šéƒ¨ç½²åˆ°GitHub Pages
    - name: éƒ¨ç½²åˆ°ç½‘ç«™
      if: success()
      uses: JamesIves/github-pages-deploy-action@v4
      with:
        branch: gh-pages
        folder: .
